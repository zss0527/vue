<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        table {
            border: 1px solid #000;
            text-align: center;
            width: 240px;
        }

        th, td {
            border: 1px solid #000;
        }

        h3 {
            position: relative;
        }
    </style>
    <link rel="stylesheet" href="css/score.css"/>
</head>
<body>

<div id="app">
    <h3>小黑的礼物清单</h3>
    <table>
        <tr>
            <th>名字</th>
            <th>数量</th>
        </tr>
        <tr v-for="(item, index) in list" :key="item.id">
            <td>{{ item.name }}</td>
            <td>{{ item.num }}个</td>
        </tr>
    </table>

    <!-- 目标：统计求和，求得礼物总数 -->
    <p>礼物总数：{{totalCount}} 个</p>
    <p>礼物总数：{{totalCount}} 个</p>
    <p>礼物总数：{{totalCountFn()}} 个</p>
    <p>礼物总数：{{totalCountFn()}} 个</p>


    姓：<input type="text" v-model="firstName"><br>
    名：<input type="text" v-model="lastName"><br>
    <p>姓名：{{fullNameComplete}}</p>
    <button @click="changeName">修改姓名</button>
    <br>

    <div id="score" class="score-case">
        <div class="table">
            <table>
                <thead>
                <tr>
                    <th>编号</th>
                    <th>科目</th>
                    <th>成绩</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody v-if="scoreList.length > 0">
                <tr v-for="(item, index) in scoreList" :key="item.id">
                    <td>{{item.id}}</td>
                    <td>{{item.subject}}</td>
                    <td :class="{'red':item.score < 60}">{{item.score}}</td>
                    <td><a @click="deleteScoreItem(item.id)" href="#">删除</a></td>
                </tr>
                </tbody>
                <tbody v-else>
                <tr>
                    <td colspan="5">
                        <span class="none">暂无数据</span>
                    </td>
                </tr>
                </tbody>

                <tfoot>
                <tr>
                    <td colspan="5">
                        <span>总分：{{totalScore}}</span>
                        <span style="margin-left: 50px">平均分：{{scoreAvg}}</span>
                    </td>
                </tr>
                </tfoot>
            </table>
        </div>
        <div class="form">
            <div class="form-item">
                <div class="label">科目：</div>
                <div class="input">
                    <input
                            type="text"
                            placeholder="请输入科目"
                            v-model.trim="subject"
                    />
                </div>
            </div>
            <div class="form-item">
                <div class="label">分数：</div>
                <div class="input">
                    <input
                            type="text"
                            placeholder="请输入分数"
                            v-model.number.trim.numbers="score"
                    />
                </div>
            </div>
            <div class="form-item">
                <div class="label"></div>
                <div class="input">
                    <button class="submit" @click="addScoreItem">添加</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script>
    const app = new Vue({
        el: '#app',
        data: {
            // 现有的数据
            list: [
                {id: 1, name: '篮球', num: 1},
                {id: 2, name: '玩具', num: 2},
                {id: 3, name: '铅笔', num: 5},
            ],
            firstName: '',
            lastName: '',

            scoreList: [
                {id: 1, subject: '语文', score: 20},
                {id: 7, subject: '数学', score: 99},
                {id: 12, subject: '英语', score: 70},
            ],
            subject: '',
            score: ''
        },
        methods: {
            totalCountFn() {
                console.log('methods run...')
                return this.list.reduce((pre, cur) => pre + cur.num, 0)
            },
            changeName() {
                this.fullNameComplete = 'Larry Zhu'
            },

            deleteScoreItem(id) {
                console.log('delete score item:',id)
                this.scoreList = this.scoreList.filter(item => item.id !== id)
            },

            addScoreItem() {
                if(!this.subject) {
                    alert('Please input subject')
                    return
                }
                if(typeof this.score !== 'number') {
                    alert('Please input number as score')
                    return
                }
                this.scoreList.push({
                id: this.scoreList.slice(-1)[0].id + 1,
                subject: this.subject,
                score: this.score
                })
                this.score = ''
                this.subject = ''
            }
        },
        computed: {
            totalCount: function () {
                console.log('computed run...')
                return this.list.reduce((pre, cur) => pre + cur.num, 0)
            },
            fullName: function () {
                return this.firstName + this.lastName
            },
            fullNameComplete: {
                get() {
                    return this.firstName + this.lastName
                },
                set(value) {
                    console.log('value:', value)
                    this.firstName = value.slice(0, 1)
                    this.lastName = value.slice(1)
                }
            },
            totalScore: function () {
                return this.scoreList.reduce((pre, cur) => pre + cur.score, 0)
            },
            scoreAvg: function () {
                if(this.scoreList.length === 0) {
                    return 0
                }

                return (this.totalScore / this.scoreList.length).toFixed(2)
            }
        },

    })
</script>
</body>
</html>